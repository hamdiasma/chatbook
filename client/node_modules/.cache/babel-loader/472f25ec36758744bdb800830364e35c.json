{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\owner\\\\Desktop\\\\my-applications\\\\social-media\\\\client\\\\src\\\\components\\\\modal\\\\CallModel.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Avatar from \"../avatar/Avatar\";\nimport { alertTypes, globalTypes } from \"../../redux/type/types\";\nimport { stopTracks } from \"../../utils/tracks\";\nimport { timer } from \"../../utils/timer\";\nimport { addMessageAction } from \"../../redux/actions/message\";\nimport audioRingRecip from \"../../audio/ringring.mp3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction CallModel() {\n  _s();\n\n  const {\n    call,\n    auth,\n    theme,\n    peer,\n    socket\n  } = useSelector(state => state);\n  const dispatch = useDispatch();\n  const [hours, setHours] = useState(0);\n  const [mins, setMins] = useState(0);\n  const [seconds, setSeconds] = useState(0);\n  const [total, setTotal] = useState(0);\n  const [answer, setAnswer] = useState(false);\n  const [tracks, setTracks] = useState(null);\n  const [newCall, setNewcall] = useState(null); // const [audio, setAudio] = useState(true);\n\n  const youVideo = useRef();\n  const otherVideo = useRef();\n  const audeiReRef = useRef(); // time\n\n  useEffect(() => {\n    const setTime = () => {\n      setTotal(t => t + 1);\n      setTimeout(setTime, 1000);\n    };\n\n    setTime();\n    return () => setTotal(0);\n  }, []);\n  useEffect(() => {\n    setSeconds(total % 60);\n    setMins(parseInt(total / 60));\n    setHours(parseInt(total / 3600));\n  }, [total]); // end call\n\n  const addCallMsg = useCallback((call, times, disconnect) => {\n    if (call.recipient !== auth.user._id || disconnect) {\n      const msg = {\n        sender: call.sender,\n        recipient: call.recipient,\n        text: \"\",\n        media: [],\n        call: {\n          video: call.video,\n          times\n        },\n        createdAt: new Date().toISOString()\n      };\n      dispatch(addMessageAction({\n        msg,\n        auth,\n        socket\n      }));\n    }\n  }, [auth, dispatch, socket]);\n\n  const handleCloseCall = () => {\n    stopTracks(tracks);\n    if (newCall) newCall.close();\n    let times = answer ? total : 0;\n    socket.emit(\"endCall\", { ...call,\n      times\n    });\n    addCallMsg(call, times);\n    dispatch({\n      type: globalTypes.CALL,\n      payload: null\n    });\n  };\n\n  useEffect(() => {\n    if (answer) {\n      setTotal(0);\n    } else {\n      const timer = setTimeout(() => {\n        dispatch({\n          type: globalTypes.CALL,\n          payload: null\n        });\n        socket.emit(\"endCall\", { ...call,\n          times: 0\n        });\n        addCallMsg(call, 0);\n      }, 15000);\n      return () => clearTimeout(timer);\n    }\n  }, [dispatch, answer, call, socket, addCallMsg]);\n  useEffect(() => {\n    socket.on(\"endCallToClient\", data => {\n      tracks && stopTracks(tracks);\n      if (newCall) newCall.close();\n      addCallMsg(data, data.times);\n      dispatch({\n        type: globalTypes.CALL,\n        payload: null\n      });\n    });\n    return () => socket.off(\"endCallToClient\");\n  }, [dispatch, socket, tracks, addCallMsg, newCall]); // straem video\n\n  const openStream = video => {\n    const config = {\n      audio: true,\n      video\n    };\n    return navigator.mediaDevices.getUserMedia(config);\n  };\n\n  const playStream = (tag, stream) => {\n    let video = tag;\n    video.srcObject = stream;\n    video.play();\n  }; // answer call\n\n\n  const handleAnsware = () => {\n    openStream(call.video).then(stream => {\n      playStream(youVideo.current, stream);\n      const track = stream.getTracks();\n      setTracks(track);\n      const newCall = peer.call(call.peerId, stream);\n      newCall && newCall.on(\"stream\", function (remoteStream) {\n        playStream(otherVideo.current, remoteStream);\n      });\n      setAnswer(true);\n      setNewcall(newCall);\n    });\n  };\n\n  useEffect(() => {\n    // call.answer(stream); // Answer the call with an A/V stream.\n    peer.on(\"call\", newCall => {\n      openStream(call.video).then(stream => {\n        if (youVideo.current) {\n          playStream(youVideo.current, stream);\n        }\n\n        const track = stream.getTracks();\n        setTracks(track);\n        newCall.answer(stream);\n        newCall.on(\"stream\", function (remoteStream) {\n          if (otherVideo.current) {\n            playStream(otherVideo.current, remoteStream);\n          }\n        });\n        setAnswer(true);\n        setNewcall(newCall);\n      });\n    });\n    return () => peer.removeListener(\"call\");\n  }, [peer, call.video]); // disconnecr\n\n  useEffect(() => {\n    socket.on(\"callerDisconnect\", () => {\n      tracks && stopTracks(tracks);\n      if (newCall) newCall.close();\n      socket.emit(\"endCall\", call);\n      const times = answer ? total : 0;\n      addCallMsg(call, times, true);\n      dispatch({\n        type: globalTypes.CALL,\n        payload: null\n      });\n      dispatch({\n        type: alertTypes.ALERT_MESSAGE,\n        payload: {\n          error: `${call.fullname + \" \" + call.username} is disconnect`\n        }\n      });\n    });\n    return () => socket.off(\"callerDisconnect\");\n  }, [dispatch, socket, tracks, call, addCallMsg, answer, total, newCall]); // play && pause audio\n\n  const playAudio = newAudio => {\n    newAudio.play();\n  };\n\n  const pauseAudio = newAudio => {\n    newAudio.pause();\n    newAudio.currentTime = 0;\n  };\n\n  useEffect(() => {\n    let newAudio = new Audio(audioRingRecip);\n\n    if (answer) {\n      pauseAudio(newAudio);\n    } else {\n      playAudio(newAudio);\n    }\n\n    return () => pauseAudio(newAudio);\n  }, [answer]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"call_model\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"call_box\",\n      style: {\n        display: answer && call.video ? \"none\" : \"flex\",\n        filter: theme ? \"invert(1)\" : \"invert(0)\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        style: {\n          padding: \"40px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          src: call.avatar,\n          size: \"xbig-avatar\",\n          style: {\n            display: answer && call.video ? \"none\" : \"flex\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: call.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          children: call.fullname\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this), answer ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"timer\",\n          children: timer(hours, mins, seconds)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: call.video ? /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"calling video...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"calling audio...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), !answer && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"timer\",\n        children: timer(hours, mins, seconds)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"call_menu \",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-times text-danger\",\n          onClick: handleCloseCall,\n          style: {\n            opacity: answer && call.video ? 0 : 1\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this), call.recipient === auth.user._id && !answer && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: call.video ? /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas  fa-video pointer\",\n            style: {\n              filter: theme ? \"invert(1)\" : \"invert(0)\",\n              color: theme ? \"#329c0cd1\" : \"\"\n            },\n            onClick: handleAnsware\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-phone pointer\",\n            style: {\n              filter: theme ? \"invert(1)\" : \"invert(0)\",\n              color: theme ? \"#329c0cd1\" : \"#329c0cd1\"\n            },\n            onClick: handleAnsware\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 17\n          }, this)\n        }, void 0, false)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"show_video\",\n      style: {\n        opacity: answer && call.video ? 1 : 0,\n        filter: theme ? \"invert(1)\" : \"invert(0)\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: youVideo,\n        className: \"your_video\",\n        playsInline: true,\n        muted: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: otherVideo,\n        className: \"other_video\",\n        playsInline: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"timer time_video\",\n        children: timer(hours, mins, seconds)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"call_menu\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-times text-danger end_call\",\n          onClick: handleCloseCall\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      controls: true,\n      ref: audeiReRef,\n      style: {\n        display: \"none\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"source\", {\n        src: call.recipient === auth.user._id ? audioRingRecip : audioRingRecip,\n        type: \"audio/wav\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CallModel, \"Zo/cmmjkeh4/dlsWtXs418DNsKk=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = CallModel;\nCallModel.propTypes = {\n  auth: PropTypes.object\n};\nexport default CallModel;\n\nvar _c;\n\n$RefreshReg$(_c, \"CallModel\");","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","PropTypes","useDispatch","useSelector","Avatar","alertTypes","globalTypes","stopTracks","timer","addMessageAction","audioRingRecip","CallModel","call","auth","theme","peer","socket","state","dispatch","hours","setHours","mins","setMins","seconds","setSeconds","total","setTotal","answer","setAnswer","tracks","setTracks","newCall","setNewcall","youVideo","otherVideo","audeiReRef","setTime","t","setTimeout","parseInt","addCallMsg","times","disconnect","recipient","user","_id","msg","sender","text","media","video","createdAt","Date","toISOString","handleCloseCall","close","emit","type","CALL","payload","clearTimeout","on","data","off","openStream","config","audio","navigator","mediaDevices","getUserMedia","playStream","tag","stream","srcObject","play","handleAnsware","then","current","track","getTracks","peerId","remoteStream","removeListener","ALERT_MESSAGE","error","fullname","username","playAudio","newAudio","pauseAudio","pause","currentTime","Audio","display","filter","padding","avatar","opacity","color","propTypes","object"],"sources":["C:/Users/owner/Desktop/my-applications/social-media/client/src/components/modal/CallModel.jsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport Avatar from \"../avatar/Avatar\";\r\nimport { alertTypes, globalTypes } from \"../../redux/type/types\";\r\nimport { stopTracks } from \"../../utils/tracks\";\r\nimport { timer } from \"../../utils/timer\";\r\nimport { addMessageAction } from \"../../redux/actions/message\";\r\nimport audioRingRecip from \"../../audio/ringring.mp3\";\r\n\r\nfunction CallModel() {\r\n  const { call, auth, theme, peer, socket } = useSelector((state) => state);\r\n  const dispatch = useDispatch();\r\n  const [hours, setHours] = useState(0);\r\n  const [mins, setMins] = useState(0);\r\n  const [seconds, setSeconds] = useState(0);\r\n  const [total, setTotal] = useState(0);\r\n  const [answer, setAnswer] = useState(false);\r\n  const [tracks, setTracks] = useState(null);\r\n  const [newCall, setNewcall] = useState(null);\r\n  // const [audio, setAudio] = useState(true);\r\n  const youVideo = useRef();\r\n  const otherVideo = useRef();\r\n  const audeiReRef = useRef();\r\n  // time\r\n  useEffect(() => {\r\n    const setTime = () => {\r\n      setTotal((t) => t + 1);\r\n      setTimeout(setTime, 1000);\r\n    };\r\n    setTime();\r\n    return () => setTotal(0);\r\n  }, []);\r\n  useEffect(() => {\r\n    setSeconds(total % 60);\r\n    setMins(parseInt(total / 60));\r\n    setHours(parseInt(total / 3600));\r\n  }, [total]);\r\n\r\n  // end call\r\n  const addCallMsg = useCallback(\r\n    (call, times, disconnect) => {\r\n      if (call.recipient !== auth.user._id || disconnect) {\r\n        const msg = {\r\n          sender: call.sender,\r\n          recipient: call.recipient,\r\n          text: \"\",\r\n          media: [],\r\n          call: { video: call.video, times },\r\n          createdAt: new Date().toISOString(),\r\n        };\r\n        dispatch(addMessageAction({ msg, auth, socket }));\r\n      }\r\n    },\r\n    [auth, dispatch, socket]\r\n  );\r\n  const handleCloseCall = () => {\r\n    stopTracks(tracks);\r\n    if (newCall) newCall.close();\r\n\r\n    let times = answer ? total : 0;\r\n    socket.emit(\"endCall\", { ...call, times });\r\n\r\n    addCallMsg(call, times);\r\n\r\n    dispatch({\r\n      type: globalTypes.CALL,\r\n      payload: null,\r\n    });\r\n  };\r\n  useEffect(() => {\r\n    if (answer) {\r\n      setTotal(0);\r\n    } else {\r\n      const timer = setTimeout(() => {\r\n        dispatch({\r\n          type: globalTypes.CALL,\r\n          payload: null,\r\n        });\r\n        socket.emit(\"endCall\", { ...call, times: 0 });\r\n        addCallMsg(call, 0);\r\n      }, 15000);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [dispatch, answer, call, socket, addCallMsg]);\r\n  useEffect(() => {\r\n    socket.on(\"endCallToClient\", (data) => {\r\n      tracks && stopTracks(tracks);\r\n      if (newCall) newCall.close();\r\n      addCallMsg(data, data.times);\r\n      dispatch({\r\n        type: globalTypes.CALL,\r\n        payload: null,\r\n      });\r\n    });\r\n    return () => socket.off(\"endCallToClient\");\r\n  }, [dispatch, socket, tracks, addCallMsg, newCall]);\r\n  // straem video\r\n  const openStream = (video) => {\r\n    const config = { audio: true, video };\r\n    return navigator.mediaDevices.getUserMedia(config);\r\n  };\r\n\r\n  const playStream = (tag, stream) => {\r\n    let video = tag;\r\n    video.srcObject = stream;\r\n    video.play();\r\n  };\r\n  // answer call\r\n  const handleAnsware = () => {\r\n    openStream(call.video).then((stream) => {\r\n      playStream(youVideo.current, stream);\r\n\r\n      const track = stream.getTracks();\r\n      setTracks(track);\r\n\r\n      const newCall = peer.call(call.peerId, stream);\r\n\r\n      newCall &&\r\n        newCall.on(\"stream\", function (remoteStream) {\r\n          playStream(otherVideo.current, remoteStream);\r\n        });\r\n\r\n      setAnswer(true);\r\n      setNewcall(newCall);\r\n    });\r\n  };\r\n  useEffect(() => {\r\n    // call.answer(stream); // Answer the call with an A/V stream.\r\n    peer.on(\"call\", (newCall) => {\r\n      openStream(call.video).then((stream) => {\r\n        if (youVideo.current) {\r\n          playStream(youVideo.current, stream);\r\n        }\r\n        const track = stream.getTracks();\r\n        setTracks(track);\r\n        newCall.answer(stream);\r\n\r\n        newCall.on(\"stream\", function (remoteStream) {\r\n          if (otherVideo.current) {\r\n            playStream(otherVideo.current, remoteStream);\r\n          }\r\n        });\r\n\r\n        setAnswer(true);\r\n        setNewcall(newCall);\r\n      });\r\n    });\r\n\r\n    return () => peer.removeListener(\"call\");\r\n  }, [peer, call.video]);\r\n  // disconnecr\r\n  useEffect(() => {\r\n    socket.on(\"callerDisconnect\", () => {\r\n      tracks && stopTracks(tracks);\r\n      if (newCall) newCall.close();\r\n      socket.emit(\"endCall\", call);\r\n      const times = answer ? total : 0;\r\n      addCallMsg(call, times, true);\r\n      dispatch({\r\n        type: globalTypes.CALL,\r\n        payload: null,\r\n      });\r\n      dispatch({\r\n        type: alertTypes.ALERT_MESSAGE,\r\n        payload: {\r\n          error: `${call.fullname + \" \" + call.username} is disconnect`,\r\n        },\r\n      });\r\n    });\r\n    return () => socket.off(\"callerDisconnect\");\r\n  }, [dispatch, socket, tracks, call, addCallMsg, answer, total, newCall]);\r\n  // play && pause audio\r\n\r\n  const playAudio = (newAudio) => {\r\n    newAudio.play();\r\n  };\r\n  const pauseAudio = (newAudio) => {\r\n    newAudio.pause();\r\n    newAudio.currentTime = 0;\r\n  };\r\n\r\n  useEffect(() => {\r\n    let newAudio = new Audio(audioRingRecip);\r\n    if (answer) {\r\n      pauseAudio(newAudio);\r\n    } else {\r\n      playAudio(newAudio);\r\n    }\r\n    return () => pauseAudio(newAudio);\r\n  }, [answer]);\r\n\r\n  return (\r\n    <div className=\"call_model\">\r\n      <div\r\n        className=\"call_box\"\r\n        style={{\r\n          display: answer && call.video ? \"none\" : \"flex\",\r\n          filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n        }}\r\n      >\r\n        <div className=\"text-center\" style={{ padding: \"40px\" }}>\r\n          <Avatar\r\n            src={call.avatar}\r\n            size=\"xbig-avatar\"\r\n            style={{\r\n              display: answer && call.video ? \"none\" : \"flex\",\r\n            }}\r\n          />\r\n          <h4>{call.username}</h4>\r\n          <h6>{call.fullname}</h6>\r\n          {answer ? (\r\n            <div className=\"timer\">{timer(hours, mins, seconds)}</div>\r\n          ) : (\r\n            <div>\r\n              {call.video ? (\r\n                <span>calling video...</span>\r\n              ) : (\r\n                <span>calling audio...</span>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n        {!answer && <div className=\"timer\">{timer(hours, mins, seconds)}</div>}\r\n        <div className=\"call_menu \">\r\n          <i\r\n            className=\"fas fa-times text-danger\"\r\n            onClick={handleCloseCall}\r\n            style={{ opacity: answer && call.video ? 0 : 1 }}\r\n          ></i>\r\n          {/* {audio ? (\r\n            <i\r\n              className=\"fas fa-microphone pointer\"\r\n              onClick={() => setAudio(false)}\r\n              style={{\r\n                filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n                color: \"#278092\",\r\n              }}\r\n            ></i>\r\n          ) : (\r\n            <i\r\n              className=\"fas fa-microphone-slash pointer\"\r\n              onClick={() => setAudio(true)}\r\n              style={{\r\n                filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n                color: theme ? \"#329c0cd1\" : \"#329c0cd1\",\r\n              }}\r\n            ></i>\r\n          )} */}\r\n\r\n          {call.recipient === auth.user._id && !answer && (\r\n            <>\r\n              {call.video ? (\r\n                <i\r\n                  className=\"fas  fa-video pointer\"\r\n                  style={{\r\n                    filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n                    color: theme ? \"#329c0cd1\" : \"\",\r\n                  }}\r\n                  onClick={handleAnsware}\r\n                ></i>\r\n              ) : (\r\n                <i\r\n                  className=\"fas fa-phone pointer\"\r\n                  style={{\r\n                    filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n                    color: theme ? \"#329c0cd1\" : \"#329c0cd1\",\r\n                  }}\r\n                  onClick={handleAnsware}\r\n                ></i>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        className=\"show_video\"\r\n        style={{\r\n          opacity: answer && call.video ? 1 : 0,\r\n          filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n        }}\r\n      >\r\n        <video ref={youVideo} className=\"your_video\" playsInline muted />\r\n        <video ref={otherVideo} className=\"other_video\" playsInline />\r\n\r\n        <div className=\"timer time_video\">{timer(hours, mins, seconds)}</div>\r\n        <span className=\"call_menu\">\r\n          <i\r\n            className=\"fas fa-times text-danger end_call\"\r\n            onClick={handleCloseCall}\r\n          ></i>\r\n          {/* {audio ? (\r\n            <i\r\n              className=\"fas fa-microphone pointer\"\r\n              onClick={() => setAudio(false)}\r\n              style={{\r\n                filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n                color: \"#278092\",\r\n              }}\r\n            ></i>\r\n          ) : (\r\n            <i\r\n              className=\"fas fa-microphone-slash pointer\"\r\n              onClick={() => setAudio(true)}\r\n              style={{\r\n                filter: theme ? \"invert(1)\" : \"invert(0)\",\r\n                color: \"#278092\",\r\n              }}\r\n            ></i>\r\n          )} */}\r\n        </span>\r\n      </div>\r\n      <audio controls ref={audeiReRef} style={{ display: \"none\" }}>\r\n        <source\r\n          src={\r\n            call.recipient === auth.user._id ? audioRingRecip : audioRingRecip\r\n          }\r\n          type=\"audio/wav\"\r\n        />\r\n      </audio>\r\n    </div>\r\n  );\r\n}\r\n\r\nCallModel.propTypes = {\r\n  auth: PropTypes.object,\r\n};\r\n\r\nexport default CallModel;\r\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,SAA7B,EAAwCC,MAAxC,EAAgDC,QAAhD,QAAgE,OAAhE;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,wBAAxC;AACA,SAASC,UAAT,QAA2B,oBAA3B;AACA,SAASC,KAAT,QAAsB,mBAAtB;AACA,SAASC,gBAAT,QAAiC,6BAAjC;AACA,OAAOC,cAAP,MAA2B,0BAA3B;;;;AAEA,SAASC,SAAT,GAAqB;EAAA;;EACnB,MAAM;IAAEC,IAAF;IAAQC,IAAR;IAAcC,KAAd;IAAqBC,IAArB;IAA2BC;EAA3B,IAAsCb,WAAW,CAAEc,KAAD,IAAWA,KAAZ,CAAvD;EACA,MAAMC,QAAQ,GAAGhB,WAAW,EAA5B;EACA,MAAM,CAACiB,KAAD,EAAQC,QAAR,IAAoBpB,QAAQ,CAAC,CAAD,CAAlC;EACA,MAAM,CAACqB,IAAD,EAAOC,OAAP,IAAkBtB,QAAQ,CAAC,CAAD,CAAhC;EACA,MAAM,CAACuB,OAAD,EAAUC,UAAV,IAAwBxB,QAAQ,CAAC,CAAD,CAAtC;EACA,MAAM,CAACyB,KAAD,EAAQC,QAAR,IAAoB1B,QAAQ,CAAC,CAAD,CAAlC;EACA,MAAM,CAAC2B,MAAD,EAASC,SAAT,IAAsB5B,QAAQ,CAAC,KAAD,CAApC;EACA,MAAM,CAAC6B,MAAD,EAASC,SAAT,IAAsB9B,QAAQ,CAAC,IAAD,CAApC;EACA,MAAM,CAAC+B,OAAD,EAAUC,UAAV,IAAwBhC,QAAQ,CAAC,IAAD,CAAtC,CATmB,CAUnB;;EACA,MAAMiC,QAAQ,GAAGlC,MAAM,EAAvB;EACA,MAAMmC,UAAU,GAAGnC,MAAM,EAAzB;EACA,MAAMoC,UAAU,GAAGpC,MAAM,EAAzB,CAbmB,CAcnB;;EACAD,SAAS,CAAC,MAAM;IACd,MAAMsC,OAAO,GAAG,MAAM;MACpBV,QAAQ,CAAEW,CAAD,IAAOA,CAAC,GAAG,CAAZ,CAAR;MACAC,UAAU,CAACF,OAAD,EAAU,IAAV,CAAV;IACD,CAHD;;IAIAA,OAAO;IACP,OAAO,MAAMV,QAAQ,CAAC,CAAD,CAArB;EACD,CAPQ,EAON,EAPM,CAAT;EAQA5B,SAAS,CAAC,MAAM;IACd0B,UAAU,CAACC,KAAK,GAAG,EAAT,CAAV;IACAH,OAAO,CAACiB,QAAQ,CAACd,KAAK,GAAG,EAAT,CAAT,CAAP;IACAL,QAAQ,CAACmB,QAAQ,CAACd,KAAK,GAAG,IAAT,CAAT,CAAR;EACD,CAJQ,EAIN,CAACA,KAAD,CAJM,CAAT,CAvBmB,CA6BnB;;EACA,MAAMe,UAAU,GAAG3C,WAAW,CAC5B,CAACe,IAAD,EAAO6B,KAAP,EAAcC,UAAd,KAA6B;IAC3B,IAAI9B,IAAI,CAAC+B,SAAL,KAAmB9B,IAAI,CAAC+B,IAAL,CAAUC,GAA7B,IAAoCH,UAAxC,EAAoD;MAClD,MAAMI,GAAG,GAAG;QACVC,MAAM,EAAEnC,IAAI,CAACmC,MADH;QAEVJ,SAAS,EAAE/B,IAAI,CAAC+B,SAFN;QAGVK,IAAI,EAAE,EAHI;QAIVC,KAAK,EAAE,EAJG;QAKVrC,IAAI,EAAE;UAAEsC,KAAK,EAAEtC,IAAI,CAACsC,KAAd;UAAqBT;QAArB,CALI;QAMVU,SAAS,EAAE,IAAIC,IAAJ,GAAWC,WAAX;MAND,CAAZ;MAQAnC,QAAQ,CAACT,gBAAgB,CAAC;QAAEqC,GAAF;QAAOjC,IAAP;QAAaG;MAAb,CAAD,CAAjB,CAAR;IACD;EACF,CAb2B,EAc5B,CAACH,IAAD,EAAOK,QAAP,EAAiBF,MAAjB,CAd4B,CAA9B;;EAgBA,MAAMsC,eAAe,GAAG,MAAM;IAC5B/C,UAAU,CAACsB,MAAD,CAAV;IACA,IAAIE,OAAJ,EAAaA,OAAO,CAACwB,KAAR;IAEb,IAAId,KAAK,GAAGd,MAAM,GAAGF,KAAH,GAAW,CAA7B;IACAT,MAAM,CAACwC,IAAP,CAAY,SAAZ,EAAuB,EAAE,GAAG5C,IAAL;MAAW6B;IAAX,CAAvB;IAEAD,UAAU,CAAC5B,IAAD,EAAO6B,KAAP,CAAV;IAEAvB,QAAQ,CAAC;MACPuC,IAAI,EAAEnD,WAAW,CAACoD,IADX;MAEPC,OAAO,EAAE;IAFF,CAAD,CAAR;EAID,CAbD;;EAcA7D,SAAS,CAAC,MAAM;IACd,IAAI6B,MAAJ,EAAY;MACVD,QAAQ,CAAC,CAAD,CAAR;IACD,CAFD,MAEO;MACL,MAAMlB,KAAK,GAAG8B,UAAU,CAAC,MAAM;QAC7BpB,QAAQ,CAAC;UACPuC,IAAI,EAAEnD,WAAW,CAACoD,IADX;UAEPC,OAAO,EAAE;QAFF,CAAD,CAAR;QAIA3C,MAAM,CAACwC,IAAP,CAAY,SAAZ,EAAuB,EAAE,GAAG5C,IAAL;UAAW6B,KAAK,EAAE;QAAlB,CAAvB;QACAD,UAAU,CAAC5B,IAAD,EAAO,CAAP,CAAV;MACD,CAPuB,EAOrB,KAPqB,CAAxB;MASA,OAAO,MAAMgD,YAAY,CAACpD,KAAD,CAAzB;IACD;EACF,CAfQ,EAeN,CAACU,QAAD,EAAWS,MAAX,EAAmBf,IAAnB,EAAyBI,MAAzB,EAAiCwB,UAAjC,CAfM,CAAT;EAgBA1C,SAAS,CAAC,MAAM;IACdkB,MAAM,CAAC6C,EAAP,CAAU,iBAAV,EAA8BC,IAAD,IAAU;MACrCjC,MAAM,IAAItB,UAAU,CAACsB,MAAD,CAApB;MACA,IAAIE,OAAJ,EAAaA,OAAO,CAACwB,KAAR;MACbf,UAAU,CAACsB,IAAD,EAAOA,IAAI,CAACrB,KAAZ,CAAV;MACAvB,QAAQ,CAAC;QACPuC,IAAI,EAAEnD,WAAW,CAACoD,IADX;QAEPC,OAAO,EAAE;MAFF,CAAD,CAAR;IAID,CARD;IASA,OAAO,MAAM3C,MAAM,CAAC+C,GAAP,CAAW,iBAAX,CAAb;EACD,CAXQ,EAWN,CAAC7C,QAAD,EAAWF,MAAX,EAAmBa,MAAnB,EAA2BW,UAA3B,EAAuCT,OAAvC,CAXM,CAAT,CA5EmB,CAwFnB;;EACA,MAAMiC,UAAU,GAAId,KAAD,IAAW;IAC5B,MAAMe,MAAM,GAAG;MAAEC,KAAK,EAAE,IAAT;MAAehB;IAAf,CAAf;IACA,OAAOiB,SAAS,CAACC,YAAV,CAAuBC,YAAvB,CAAoCJ,MAApC,CAAP;EACD,CAHD;;EAKA,MAAMK,UAAU,GAAG,CAACC,GAAD,EAAMC,MAAN,KAAiB;IAClC,IAAItB,KAAK,GAAGqB,GAAZ;IACArB,KAAK,CAACuB,SAAN,GAAkBD,MAAlB;IACAtB,KAAK,CAACwB,IAAN;EACD,CAJD,CA9FmB,CAmGnB;;;EACA,MAAMC,aAAa,GAAG,MAAM;IAC1BX,UAAU,CAACpD,IAAI,CAACsC,KAAN,CAAV,CAAuB0B,IAAvB,CAA6BJ,MAAD,IAAY;MACtCF,UAAU,CAACrC,QAAQ,CAAC4C,OAAV,EAAmBL,MAAnB,CAAV;MAEA,MAAMM,KAAK,GAAGN,MAAM,CAACO,SAAP,EAAd;MACAjD,SAAS,CAACgD,KAAD,CAAT;MAEA,MAAM/C,OAAO,GAAGhB,IAAI,CAACH,IAAL,CAAUA,IAAI,CAACoE,MAAf,EAAuBR,MAAvB,CAAhB;MAEAzC,OAAO,IACLA,OAAO,CAAC8B,EAAR,CAAW,QAAX,EAAqB,UAAUoB,YAAV,EAAwB;QAC3CX,UAAU,CAACpC,UAAU,CAAC2C,OAAZ,EAAqBI,YAArB,CAAV;MACD,CAFD,CADF;MAKArD,SAAS,CAAC,IAAD,CAAT;MACAI,UAAU,CAACD,OAAD,CAAV;IACD,CAfD;EAgBD,CAjBD;;EAkBAjC,SAAS,CAAC,MAAM;IACd;IACAiB,IAAI,CAAC8C,EAAL,CAAQ,MAAR,EAAiB9B,OAAD,IAAa;MAC3BiC,UAAU,CAACpD,IAAI,CAACsC,KAAN,CAAV,CAAuB0B,IAAvB,CAA6BJ,MAAD,IAAY;QACtC,IAAIvC,QAAQ,CAAC4C,OAAb,EAAsB;UACpBP,UAAU,CAACrC,QAAQ,CAAC4C,OAAV,EAAmBL,MAAnB,CAAV;QACD;;QACD,MAAMM,KAAK,GAAGN,MAAM,CAACO,SAAP,EAAd;QACAjD,SAAS,CAACgD,KAAD,CAAT;QACA/C,OAAO,CAACJ,MAAR,CAAe6C,MAAf;QAEAzC,OAAO,CAAC8B,EAAR,CAAW,QAAX,EAAqB,UAAUoB,YAAV,EAAwB;UAC3C,IAAI/C,UAAU,CAAC2C,OAAf,EAAwB;YACtBP,UAAU,CAACpC,UAAU,CAAC2C,OAAZ,EAAqBI,YAArB,CAAV;UACD;QACF,CAJD;QAMArD,SAAS,CAAC,IAAD,CAAT;QACAI,UAAU,CAACD,OAAD,CAAV;MACD,CAhBD;IAiBD,CAlBD;IAoBA,OAAO,MAAMhB,IAAI,CAACmE,cAAL,CAAoB,MAApB,CAAb;EACD,CAvBQ,EAuBN,CAACnE,IAAD,EAAOH,IAAI,CAACsC,KAAZ,CAvBM,CAAT,CAtHmB,CA8InB;;EACApD,SAAS,CAAC,MAAM;IACdkB,MAAM,CAAC6C,EAAP,CAAU,kBAAV,EAA8B,MAAM;MAClChC,MAAM,IAAItB,UAAU,CAACsB,MAAD,CAApB;MACA,IAAIE,OAAJ,EAAaA,OAAO,CAACwB,KAAR;MACbvC,MAAM,CAACwC,IAAP,CAAY,SAAZ,EAAuB5C,IAAvB;MACA,MAAM6B,KAAK,GAAGd,MAAM,GAAGF,KAAH,GAAW,CAA/B;MACAe,UAAU,CAAC5B,IAAD,EAAO6B,KAAP,EAAc,IAAd,CAAV;MACAvB,QAAQ,CAAC;QACPuC,IAAI,EAAEnD,WAAW,CAACoD,IADX;QAEPC,OAAO,EAAE;MAFF,CAAD,CAAR;MAIAzC,QAAQ,CAAC;QACPuC,IAAI,EAAEpD,UAAU,CAAC8E,aADV;QAEPxB,OAAO,EAAE;UACPyB,KAAK,EAAG,GAAExE,IAAI,CAACyE,QAAL,GAAgB,GAAhB,GAAsBzE,IAAI,CAAC0E,QAAS;QADvC;MAFF,CAAD,CAAR;IAMD,CAhBD;IAiBA,OAAO,MAAMtE,MAAM,CAAC+C,GAAP,CAAW,kBAAX,CAAb;EACD,CAnBQ,EAmBN,CAAC7C,QAAD,EAAWF,MAAX,EAAmBa,MAAnB,EAA2BjB,IAA3B,EAAiC4B,UAAjC,EAA6Cb,MAA7C,EAAqDF,KAArD,EAA4DM,OAA5D,CAnBM,CAAT,CA/ImB,CAmKnB;;EAEA,MAAMwD,SAAS,GAAIC,QAAD,IAAc;IAC9BA,QAAQ,CAACd,IAAT;EACD,CAFD;;EAGA,MAAMe,UAAU,GAAID,QAAD,IAAc;IAC/BA,QAAQ,CAACE,KAAT;IACAF,QAAQ,CAACG,WAAT,GAAuB,CAAvB;EACD,CAHD;;EAKA7F,SAAS,CAAC,MAAM;IACd,IAAI0F,QAAQ,GAAG,IAAII,KAAJ,CAAUlF,cAAV,CAAf;;IACA,IAAIiB,MAAJ,EAAY;MACV8D,UAAU,CAACD,QAAD,CAAV;IACD,CAFD,MAEO;MACLD,SAAS,CAACC,QAAD,CAAT;IACD;;IACD,OAAO,MAAMC,UAAU,CAACD,QAAD,CAAvB;EACD,CARQ,EAQN,CAAC7D,MAAD,CARM,CAAT;EAUA,oBACE;IAAK,SAAS,EAAC,YAAf;IAAA,wBACE;MACE,SAAS,EAAC,UADZ;MAEE,KAAK,EAAE;QACLkE,OAAO,EAAElE,MAAM,IAAIf,IAAI,CAACsC,KAAf,GAAuB,MAAvB,GAAgC,MADpC;QAEL4C,MAAM,EAAEhF,KAAK,GAAG,WAAH,GAAiB;MAFzB,CAFT;MAAA,wBAOE;QAAK,SAAS,EAAC,aAAf;QAA6B,KAAK,EAAE;UAAEiF,OAAO,EAAE;QAAX,CAApC;QAAA,wBACE,QAAC,MAAD;UACE,GAAG,EAAEnF,IAAI,CAACoF,MADZ;UAEE,IAAI,EAAC,aAFP;UAGE,KAAK,EAAE;YACLH,OAAO,EAAElE,MAAM,IAAIf,IAAI,CAACsC,KAAf,GAAuB,MAAvB,GAAgC;UADpC;QAHT;UAAA;UAAA;UAAA;QAAA,QADF,eAQE;UAAA,UAAKtC,IAAI,CAAC0E;QAAV;UAAA;UAAA;UAAA;QAAA,QARF,eASE;UAAA,UAAK1E,IAAI,CAACyE;QAAV;UAAA;UAAA;UAAA;QAAA,QATF,EAUG1D,MAAM,gBACL;UAAK,SAAS,EAAC,OAAf;UAAA,UAAwBnB,KAAK,CAACW,KAAD,EAAQE,IAAR,EAAcE,OAAd;QAA7B;UAAA;UAAA;UAAA;QAAA,QADK,gBAGL;UAAA,UACGX,IAAI,CAACsC,KAAL,gBACC;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADD,gBAGC;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA;QAJJ;UAAA;UAAA;UAAA;QAAA,QAbJ;MAAA;QAAA;QAAA;QAAA;MAAA,QAPF,EA6BG,CAACvB,MAAD,iBAAW;QAAK,SAAS,EAAC,OAAf;QAAA,UAAwBnB,KAAK,CAACW,KAAD,EAAQE,IAAR,EAAcE,OAAd;MAA7B;QAAA;QAAA;QAAA;MAAA,QA7Bd,eA8BE;QAAK,SAAS,EAAC,YAAf;QAAA,wBACE;UACE,SAAS,EAAC,0BADZ;UAEE,OAAO,EAAE+B,eAFX;UAGE,KAAK,EAAE;YAAE2C,OAAO,EAAEtE,MAAM,IAAIf,IAAI,CAACsC,KAAf,GAAuB,CAAvB,GAA2B;UAAtC;QAHT;UAAA;UAAA;UAAA;QAAA,QADF,EA0BGtC,IAAI,CAAC+B,SAAL,KAAmB9B,IAAI,CAAC+B,IAAL,CAAUC,GAA7B,IAAoC,CAAClB,MAArC,iBACC;UAAA,UACGf,IAAI,CAACsC,KAAL,gBACC;YACE,SAAS,EAAC,uBADZ;YAEE,KAAK,EAAE;cACL4C,MAAM,EAAEhF,KAAK,GAAG,WAAH,GAAiB,WADzB;cAELoF,KAAK,EAAEpF,KAAK,GAAG,WAAH,GAAiB;YAFxB,CAFT;YAME,OAAO,EAAE6D;UANX;YAAA;YAAA;YAAA;UAAA,QADD,gBAUC;YACE,SAAS,EAAC,sBADZ;YAEE,KAAK,EAAE;cACLmB,MAAM,EAAEhF,KAAK,GAAG,WAAH,GAAiB,WADzB;cAELoF,KAAK,EAAEpF,KAAK,GAAG,WAAH,GAAiB;YAFxB,CAFT;YAME,OAAO,EAAE6D;UANX;YAAA;YAAA;YAAA;UAAA;QAXJ,iBA3BJ;MAAA;QAAA;QAAA;QAAA;MAAA,QA9BF;IAAA;MAAA;MAAA;MAAA;IAAA,QADF,eAmFE;MACE,SAAS,EAAC,YADZ;MAEE,KAAK,EAAE;QACLsB,OAAO,EAAEtE,MAAM,IAAIf,IAAI,CAACsC,KAAf,GAAuB,CAAvB,GAA2B,CAD/B;QAEL4C,MAAM,EAAEhF,KAAK,GAAG,WAAH,GAAiB;MAFzB,CAFT;MAAA,wBAOE;QAAO,GAAG,EAAEmB,QAAZ;QAAsB,SAAS,EAAC,YAAhC;QAA6C,WAAW,MAAxD;QAAyD,KAAK;MAA9D;QAAA;QAAA;QAAA;MAAA,QAPF,eAQE;QAAO,GAAG,EAAEC,UAAZ;QAAwB,SAAS,EAAC,aAAlC;QAAgD,WAAW;MAA3D;QAAA;QAAA;QAAA;MAAA,QARF,eAUE;QAAK,SAAS,EAAC,kBAAf;QAAA,UAAmC1B,KAAK,CAACW,KAAD,EAAQE,IAAR,EAAcE,OAAd;MAAxC;QAAA;QAAA;QAAA;MAAA,QAVF,eAWE;QAAM,SAAS,EAAC,WAAhB;QAAA,uBACE;UACE,SAAS,EAAC,mCADZ;UAEE,OAAO,EAAE+B;QAFX;UAAA;UAAA;UAAA;QAAA;MADF;QAAA;QAAA;QAAA;MAAA,QAXF;IAAA;MAAA;MAAA;MAAA;IAAA,QAnFF,eAwHE;MAAO,QAAQ,MAAf;MAAgB,GAAG,EAAEnB,UAArB;MAAiC,KAAK,EAAE;QAAE0D,OAAO,EAAE;MAAX,CAAxC;MAAA,uBACE;QACE,GAAG,EACDjF,IAAI,CAAC+B,SAAL,KAAmB9B,IAAI,CAAC+B,IAAL,CAAUC,GAA7B,GAAmCnC,cAAnC,GAAoDA,cAFxD;QAIE,IAAI,EAAC;MAJP;QAAA;QAAA;QAAA;MAAA;IADF;MAAA;MAAA;MAAA;IAAA,QAxHF;EAAA;IAAA;IAAA;IAAA;EAAA,QADF;AAmID;;GA1TQC,S;UACqCR,W,EAC3BD,W;;;KAFVS,S;AA4TTA,SAAS,CAACwF,SAAV,GAAsB;EACpBtF,IAAI,EAAEZ,SAAS,CAACmG;AADI,CAAtB;AAIA,eAAezF,SAAf"},"metadata":{},"sourceType":"module"}